<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-09-09 Wed 15:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ldlework's init.el</title>
<meta name="generator" content="Org mode" />
<meta name="description" content="A literate programming style exposition of my Emacs configuration"
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/" src="https://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">ldlework's init.el</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org0558861">org-mode</a>
<ul>
<li><a href="#org6d8d6b7">straight.el fixes</a>
<ul>
<li><a href="#orgc72d0e3">fix-org-git-version</a></li>
<li><a href="#org3191d21">fix-org-release</a></li>
</ul>
</li>
<li><a href="#org4f841a7">installation</a></li>
<li><a href="#orgf99ab75">security</a></li>
<li><a href="#org72cca6c">look</a>
<ul>
<li><a href="#orgfda18df">indent by header level</a></li>
<li><a href="#orgdcd039d">pretty heading bullets</a></li>
<li><a href="#org9271311">pretty priority cookies</a></li>
<li><a href="#org3cdb434">pretty heading ellipsis</a></li>
<li><a href="#orgd9b9879">dynamic tag position</a></li>
</ul>
</li>
<li><a href="#org9c6adb9">feel</a>
<ul>
<li><a href="#org17ac5a3">don't fold blocks on open</a></li>
<li><a href="#org1d071ef">auto-fill paragraphs</a></li>
<li><a href="#org3c439a4">respect content on heading insert</a></li>
<li><a href="#org5a9390a">ensure one-line between headers</a></li>
<li><a href="#org330d537">initial visibility</a></li>
</ul>
</li>
<li><a href="#orgb666b03">todo states</a></li>
<li><a href="#org8dc97eb">poly-org</a></li>
<li><a href="#org052b771">org-modules</a></li>
<li><a href="#org9772a78">org-babel</a>
<ul>
<li><a href="#org3cd6a33">add languages to babel</a></li>
<li><a href="#org90b7c7a">set default header args</a></li>
<li><a href="#orgdeba657">disable code evaluation prompts</a></li>
</ul>
</li>
<li><a href="#orgb4e79aa">org-helm</a></li>
<li><a href="#orgab538b3">org-projectile</a></li>
<li><a href="#org08c4180">org-capture</a>
<ul>
<li><a href="#org5668760">set default notes file</a></li>
<li><a href="#org039284f">bind a key for capture</a></li>
<li><a href="#orga3aa8a3">automatically visit new capture</a></li>
<li><a href="#orgf2666dc">capture templates</a></li>
</ul>
</li>
<li><a href="#orga1b98c5">org-agenda</a></li>
<li><a href="#org6f9088e">org-fragtog</a></li>
<li><a href="#org5a5b008">linkmarks</a></li>
<li><a href="#orgec4bf65">outshine</a></li>
<li><a href="#org58cd020">org-ql</a></li>
<li><a href="#org7371913">i-read-this</a></li>
<li><a href="#org76cae90">don't prompt to confirm not prompting to confirm</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org0558861" class="outline-2">
<h2 id="org0558861">org-mode</h2>
<div class="outline-text-2" id="text-org0558861">
</div>
<div id="outline-container-org6d8d6b7" class="outline-3">
<h3 id="org6d8d6b7">straight.el fixes</h3>
<div class="outline-text-3" id="text-org6d8d6b7">
<p>
There are some issues with straight.el and org. These the following boilerplate
fixes all that until <a href="https://github.com/raxod502/straight.el#installing-org-with-straightel">that is resolved</a>.
</p>
</div>

<div id="outline-container-orgc72d0e3" class="outline-4">
<h4 id="orgc72d0e3">fix-org-git-version</h4>
<div class="outline-text-4" id="text-orgc72d0e3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun fix-org-git-version ()
  "The Git version of org-mode.
  Inserted by installing org-mode or when a release is made."
  (require 'git)
  (let ((git-repo (expand-file-name
                   "straight/repos/org/" user-emacs-directory)))
    (string-trim
     (git-run "describe"
              "--match=release\*"
              "--abbrev=6"
              "HEAD"))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3191d21" class="outline-4">
<h4 id="org3191d21">fix-org-release</h4>
<div class="outline-text-4" id="text-org3191d21">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun fix-org-release ()
  "The release version of org-mode.
  Inserted by installing org-mode or when a release is made."
  (require 'git)
  (let ((git-repo (expand-file-name
                   "straight/repos/org/" user-emacs-directory)))
    (string-trim
     (string-remove-prefix
      "release_"
      (git-run "describe"
               "--match=release\*"
               "--abbrev=0"
               "HEAD")))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4f841a7" class="outline-3">
<h3 id="org4f841a7">installation</h3>
<div class="outline-text-3" id="text-org4f841a7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package org
  :demand t
  :mode ("\\.org\\'" . org-mode)
  :config
  ;; these depend on the 'straight.el fixes' above
  (defalias #'org-git-version #'fix-org-git-version)
  (defalias #'org-release #'fix-org-release)
  (require 'org-habit)
  (require 'org-capture)
  (require 'org-tempo))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf99ab75" class="outline-3">
<h3 id="orgf99ab75">security</h3>
<div class="outline-text-3" id="text-orgf99ab75">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(progn
  (setq org-confirm-babel-evaluate nil)
  (setq org-confirm-elisp-link-function nil)
  (setq org-confirm-shell-link-function nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-org72cca6c" class="outline-3">
<h3 id="org72cca6c">look</h3>
<div class="outline-text-3" id="text-org72cca6c">
<p>
The following sections change how Org-mode documents look.
</p>
</div>

<div id="outline-container-orgfda18df" class="outline-4">
<h4 id="orgfda18df">indent by header level</h4>
<div class="outline-text-4" id="text-orgfda18df">
<p>
Hide the heading asterisks. Instead indent headings based on depth.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (add-hook 'org-mode-hook #'org-indent-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdcd039d" class="outline-4">
<h4 id="orgdcd039d">pretty heading bullets</h4>
<div class="outline-text-4" id="text-orgdcd039d">
<p>
Use nice unicode bullets instead of the default asterisks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package org-bullets
  :after (org)
  :config
  (add-hook 'org-mode-hook 'org-bullets-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9271311" class="outline-4">
<h4 id="org9271311">pretty priority cookies</h4>
<div class="outline-text-4" id="text-org9271311">
<p>
Instead of the default <code>[#A]</code> and <code>[#C]</code> priority cookies, use little unicode arrows to
indicate high and low priority. <code>[#B]</code>, which is the same as no priority, is shown as
normal.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(with-eval-after-load 'org
  (defun nougat/org-pretty-compose-p (start end match)
    (if (or (string= match "[#A]") (string= match "[#C]"))
        ;; prettify asterisks in headings
        (org-match-line org-outline-regexp-bol)
      ;; else rely on the default function
      (funcall #'prettify-symbols-default-compose-p start end match)))

  (global-prettify-symbols-mode)

  (add-hook
   'org-mode-hook
   (lambda ()
     (setq-local prettify-symbols-compose-predicate #'nougat/org-pretty-compose-p)
     (setq-local prettify-symbols-alist
                 (todo-prettify-symbols-alist todo-keywords)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3cdb434" class="outline-4">
<h4 id="org3cdb434">pretty heading ellipsis</h4>
<div class="outline-text-4" id="text-org3cdb434">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (setq org-ellipsis " ▿"))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd9b9879" class="outline-4">
<h4 id="orgd9b9879">dynamic tag position</h4>
<div class="outline-text-4" id="text-orgd9b9879">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun org-realign-tags ()
  (interactive)
  (setq org-tags-column (- 0 (window-width)))
  (org-align-tags t))

(add-hook 'window-configuration-change-hook 'org-realign-tags)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9c6adb9" class="outline-3">
<h3 id="org9c6adb9">feel</h3>
<div class="outline-text-3" id="text-org9c6adb9">
<p>
The following sections change how it feels to use Org-mode.
</p>
</div>

<div id="outline-container-org17ac5a3" class="outline-4">
<h4 id="org17ac5a3">don't fold blocks on open</h4>
<div class="outline-text-4" id="text-org17ac5a3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (setq org-hide-block-startup nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1d071ef" class="outline-4">
<h4 id="org1d071ef">auto-fill paragraphs</h4>
<div class="outline-text-4" id="text-org1d071ef">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (add-hook 'org-mode-hook 'turn-on-auto-fill))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3c439a4" class="outline-4">
<h4 id="org3c439a4">respect content on heading insert</h4>
<div class="outline-text-4" id="text-org3c439a4">
<p>
If you try to insert a heading in the middle of an entry, don't split it in half, but
instead insert the new heading after the end of the current entry.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (setq org-insert-heading-respect-content nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5a9390a" class="outline-4">
<h4 id="org5a9390a">ensure one-line between headers</h4>
<div class="outline-text-4" id="text-org5a9390a">
<p>
When you save, this section will ensure that there is a one-line space between each
heading. This helps with the background color of code-blocks not showing up on folded
headings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; (defun my/org-no-line-before-headlines ()
;;   (beginning-of-buffer)
;;   (while (re-search-forward "\n\\{3,\\}\\*" nil t)
;;     (replace-match "\n\n*")))

;; (defun my/org-one-line-after-headlines ()
;;   (beginning-of-buffer)
;;   (while (re-search-forward "^\\*+.*\n\\{2,\\}" nil t)
;;     (outline-previous-heading)
;;     (end-of-line)
;;     (forward-char)
;;     (while (looking-at "^[:space:]*$")
;;       (kill-line))))

;; (defun my/org-trim-headlines ()
;;   (let ((markers nil))
;;     (org-element-map (org-element-parse-buffer) '(headline)
;;       (lambda (paragraph)
;;         (let ((contents-end (org-element-property :contents-end paragraph))
;;               (post-blank (org-element-property :post-blank paragraph))
;;               (marker (make-marker)))
;;           (goto-char contents-end)
;;           (unless (eq 0 post-blank)
;;             (set-marker marker contents-end)
;;             (setq markers (append markers (list (cons marker post-blank))))))))
;;     (--each markers (save-excursion
;;                       (goto-char (car it))
;;                       (kill-line (- (cdr it) 1))))))

;; (defun my/org-element-type-at-point ()
;;   (car (org-element-at-point)))

;; (defun my/org-point-at-headline ()
;;   (let* ((element-type (my/org-element-type-at-point)))
;;     (eq 'headline element-type)))

;; (defun my/org-mark-elements (data types marker-prop &amp;rest props)
;;   (let ((markers nil))
;;     (org-element-map data types
;;       (lambda (element)
;;         (let* ((marker (make-marker))
;;                (marker-pos (org-element-property marker-prop element))
;;                (prop-map (make-hash-table)))
;;           (when marker-pos
;;             (set-marker marker marker-pos)
;;             (--each props (map-put! prop-map it (org-element-property it element)))
;;             (setq markers (append markers (list (cons marker prop-map))))))))

;;     markers))

;; (defun my/org-visit-markers (markers)
;;   (--each markers
;;     (goto-char (car it))
;;     (sit-for 1)))

;; (defun my/org-visit-elements (types &amp;optional data)
;;   (setq data (or data (org-element-parse-buffer)))
;;   (my/org-visit-markers (my/org-mark-elements data types :begin)))

;; (defun my/org-trim-headlines ()
;;   (save-excursion
;;     (--each (my/org-mark-elements (org-element-parse-buffer) '(headline) :begin :pre-blank)
;;       (let* ((prop-map (cdr it))
;;              (pre-blank (map-elt prop-map :pre-blank)))
;;         (when (&gt; pre-blank 1)
;;           (goto-char (car it))
;;           (end-of-line)
;;           (forward-char)
;;           (sit-for 1)
;;           (kill-line (max 0 pre-blank)))))))

;; (defun my/org-trim-paragraphs ()
;;   (save-excursion
;;     (--each (my/org-mark-elements (org-element-parse-buffer) '(paragraph section src-block) :contents-end :post-blank)
;;       (let* ((prop-map (cdr it))
;;              (post-blank (map-elt prop-map :post-blank)))
;;         (if (&gt; post-blank 1)
;;             (progn (goto-char (car it))
;;              (sit-for 1)
;;              (kill-line (max 0 (- post-blank 1))))
;;           (when (eq 0 post-blank)
;;             (goto-char (car it))
;;             (end-of-line)
;;             (forward-char)
;;             (open-line 1)))))))

;; (defun my/org-cleanup ()
;;   (interactive)
;;   (my/org-trim-headlines)
;;   (my/org-trim-paragraphs))


;; (with-eval-after-load 'org
;;   (add-hook
;;    'org-mode-hook
;;    (lambda () (add-hook
;;           'before-save-hook
;;           'my/org-cleanup
;;           nil 'make-it-local))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org330d537" class="outline-4">
<h4 id="org330d537">initial visibility</h4>
<div class="outline-text-4" id="text-org330d537">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq org-startup-folded 'content)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb666b03" class="outline-3">
<h3 id="orgb666b03">todo states</h3>
<div class="outline-text-3" id="text-orgb666b03">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq todo-keywords
      ;; normal workflow
      '((("DOING" "d"
          :icon "🏃"
          :face org-doing-face)

         ("TODO" "t"
          :icon "… "
          :face org-todo-face)

         ("DONE" "D"
          :icon "✓ "
          :face org-done-face
          :done-state t))

        ;; auxillary states
        (("SOON" "s"
          :icon "❗ "
          :face org-soon-face)

         ("SOMEDAY" "S"
          :icon "🛌"
          :face org-doing-face))))


;; parsing

(defun todo-make-state-model (name key props)
  (append (list :name name :key key) props))

(defun todo-parse-state-data (state-data)
  (-let* (((name second &amp;rest) state-data)
          ((key props) (if (stringp second)
                           (list second (cddr state-data))
                         (list nil (cdr state-data)))))
    (todo-make-state-model name key props)))

(defun todo-make-sequence-model (states)
  (mapcar 'todo-parse-state-data states))

(defun todo-parse-sequences-data (sequences-data)
  (mapcar 'todo-make-sequence-model sequences-data))


;; org-todo-keywords

(defun todo-keyword-name (name key)
  (if key (format "%s(%s)" name key) name))

(defun todo-keyword-name-for-state (state)
  (todo-keyword-name (plist-get state :name)
                     (plist-get state :key)))

(defun todo-is-done-state (state)
  (equal t (plist-get state :done-state)))

(defun todo-is-not-done-state (state)
  (equal nil (plist-get state :done-state)))

(defun todo-org-sequence (states)
  (let ((active (seq-filter 'todo-is-not-done-state states))
        (inactive (seq-filter 'todo-is-done-state states)))
    (append '(sequence)
            (mapcar 'todo-keyword-name-for-state active)
            '("|")
            (mapcar 'todo-keyword-name-for-state inactive))))

(defun todo-org-todo-keywords (sequences)
  (mapcar 'todo-org-sequence (todo-parse-sequences-data sequences)))
;; (todo-org-todo-keywords todo-keywords)


(with-eval-after-load 'org
  (setq org-todo-keywords (todo-org-todo-keywords todo-keywords)))


(defun todo-org-todo-keyword-faces (sequences)
  (cl-loop for sequence in (todo-parse-sequences-data sequences)
           append (cl-loop for state in sequence
                           for name = (plist-get state :name)
                           for face = (plist-get state :face)
                           collect (cons name face))))
;; (todo-org-todo-keyword-faces todo-keywords)

(with-eval-after-load 'org
  (setq org-todo-keyword-faces (todo-org-todo-keyword-faces todo-keywords)))

(defun todo-prettify-symbols-alist (sequences)
  (cl-loop for sequence in (todo-parse-sequences-data sequences)
           append (cl-loop for state in sequence
                           for name = (plist-get state :name)
                           for icon = (plist-get state :icon)
                           collect (cons name icon))))
;; (todo-prettify-symbols-alist todo-keywords)

(defun todo-finalize-agenda-for-state (state)
  (-let (((&amp;plist :name :icon :face) state))
    (beginning-of-buffer)
    (while (search-forward name nil 1)
      (let* ((line-props (text-properties-at (point)))
             (line-props (ecl-plist-remove line-props 'face)))
        (call-interactively 'set-mark-command)
        (search-backward name)
        (call-interactively 'kill-region)
        (let ((symbol-pos (point)))
          (insert icon)
          (beginning-of-line)
          (let ((start (point))
                (end (progn (end-of-line) (point))))
            (add-text-properties start end line-props)
            (add-face-text-property symbol-pos (+ 1 symbol-pos) face))))))
  (beginning-of-buffer)
  (replace-regexp "[[:space:]]+[=]+" ""))

(defun todo-finalize-agenda ()
  (--each (todo-parse-sequences-data todo-keywords)
    (-each it 'todo-finalize-agenda-for-state)))

(add-hook 'org-agenda-finalize-hook 'todo-finalize-agenda)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8dc97eb" class="outline-3">
<h3 id="org8dc97eb">poly-org</h3>
<div class="outline-text-3" id="text-org8dc97eb">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; (use-package poly-org)
</pre>
</div>
</div>
</div>

<div id="outline-container-org052b771" class="outline-3">
<h3 id="org052b771">org-modules</h3>
<div class="outline-text-3" id="text-org052b771">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
</pre>
</div>
</div>
</div>

<div id="outline-container-org9772a78" class="outline-3">
<h3 id="org9772a78">org-babel</h3>
<div class="outline-text-3" id="text-org9772a78">
</div>
<div id="outline-container-org3cd6a33" class="outline-4">
<h4 id="org3cd6a33">add languages to babel</h4>
<div class="outline-text-4" id="text-org3cd6a33">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((shell . t)
     (emacs-lisp . t))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org90b7c7a" class="outline-4">
<h4 id="org90b7c7a">set default header args</h4>
<div class="outline-text-4" id="text-org90b7c7a">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (setq org-babel-default-header-args
        '((:session . "none")
          (:results . "silent")
          (:exports . "code")
          (:cache . "no")
          (:noweb . "no")
          (:hlines . "no")
          (:tangle . "no"))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdeba657" class="outline-4">
<h4 id="orgdeba657">disable code evaluation prompts</h4>
<div class="outline-text-4" id="text-orgdeba657">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (setq org-confirm-babel-evaluate nil)
  (setq org-confirm-shell-link-function nil)
  (setq org-confirm-elisp-link-function nil))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb4e79aa" class="outline-3">
<h3 id="orgb4e79aa">org-helm</h3>
<div class="outline-text-3" id="text-orgb4e79aa">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package helm-org)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgab538b3" class="outline-3">
<h3 id="orgab538b3">org-projectile</h3>
<div class="outline-text-3" id="text-orgab538b3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package org-projectile
  :config
  (progn
    (org-projectile-per-project)
    (setq org-projectile-per-project-filepath "notes.org")
    (add-to-list 'org-capture-templates
                 (org-projectile-project-todo-entry
                  :capture-character "l"
                  :capture-heading "Linked Project TODO"))
    (add-to-list 'org-capture-templates
                 (org-projectile-project-todo-entry
                  :capture-character "p"))
    (setq org-confirm-elisp-link-function nil)))

(use-package org-projectile-helm
  :after org-projectile
  :bind (("C-c n p" . org-projectile-helm-template-or-project)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org08c4180" class="outline-3">
<h3 id="org08c4180">org-capture</h3>
<div class="outline-text-3" id="text-org08c4180">
</div>
<div id="outline-container-org5668760" class="outline-4">
<h4 id="org5668760">set default notes file</h4>
<div class="outline-text-4" id="text-org5668760">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (setq org-default-notes-file (my/org-file-name "inbox.org")))
</pre>
</div>
</div>
</div>

<div id="outline-container-org039284f" class="outline-4">
<h4 id="org039284f">bind a key for capture</h4>
<div class="outline-text-4" id="text-org039284f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (global-set-key (kbd "C-c c") 'org-capture))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga3aa8a3" class="outline-4">
<h4 id="orga3aa8a3">automatically visit new capture</h4>
<div class="outline-text-4" id="text-orga3aa8a3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(with-eval-after-load 'org
  (add-to-list 'org-capture-after-finalize-hook 'org-capture-goto-last-stored))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf2666dc" class="outline-4">
<h4 id="orgf2666dc">capture templates</h4>
<div class="outline-text-4" id="text-orgf2666dc">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga1b98c5" class="outline-3">
<h3 id="orga1b98c5">org-agenda</h3>
<div class="outline-text-3" id="text-orga1b98c5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq org-directory my/org-directory
      org-agenda-todo-keyword-format ""
      org-agenda-prefix-format '((todo . "  %(org-get-todo-state)"))
      org-agenda-files (-filter 'f-exists? (append
                                            (f-glob (my/org-file-name "*.org"))
                                            (f-glob (my/project-directory "*/*.org"))
                                            (f-glob (my/source-directory "*/*.org")))))

(eval `(use-package org-super-agenda
         ;; :straight (org-super-agenda
         ;;            :local-repo ,(my/source-directory "org-super-agenda"))
         :config (org-super-agenda-mode)))

(defun org-agenda-transformer (it)
  (-let* (((blank todo rest) (s-split-up-to
                              "[[:blank:]]+"
                              (substring-no-properties it) 2))
          (project-name (-&gt;&gt; it
                             (get-text-property 0 'org-marker)
                             (marker-buffer)
                             (buffer-file-name)
                             (f-parent)
                             (f-base)))
          it)
    (format "  %s %s / %s" todo project-name rest)))

(setq org-agenda-custom-commands
      (list
       (quote
        ("a" "agenda view"
         ((agenda "" ((org-agenda-span 'day)
                      (org-super-agenda-groups
                       '((:name "Today"
                                :time-grid t
                                :date today
                                :todo "TODAY"
                                :scheduled today
                                :order 1)))))
          (alltodo "" ((org-agenda-overriding-header "")
                       (org-super-agenda-groups
                        '((:name "Active"
                                 :todo "DOING"
                                 :order 1
                                 :transformer (org-agenda-transformer it))
                          (:name "Important"
                                 :tag "Important"
                                 :priority "A"
                                 :order 6)
                          (:name "Due Today"
                                 :deadline today
                                 :order 2)
                          (:name "Overdue"
                                 :deadline past
                                 :order 7)
                          (:name "Assignments"
                                 :tag "Assignment"
                                 :order 10)
                          (:name "Issues"
                                 :tag "Issue"
                                 :order 12)
                          (:name "Done"
                                 :todo "DONE")
                          (:discard (:anything t))))))

          (alltodo "" ((org-agenda-overriding-header "")
                       (org-super-agenda-groups
                        '((:auto-group-map
                           (lambda (item)
                             (-when-let* ((marker (or (get-text-property 0 'org-marker item)
                                                      (get-text-property 0 'org-hd-marker item)))
                                          (file-path (-&gt;&gt; marker marker-buffer buffer-file-name))
                                          (parent (f-dirname file-path))
                                          (type (f-dirname parent)))
                               (when (equal "src" (f-filename type))
                                 (f-filename parent)))))
                          (:discard (:anything t))))))
          (alltodo "" ((org-agenda-overriding-header "")
                       (org-super-agenda-groups
                        '((:auto-group-map
                           (lambda (item)
                             (if (-contains? (get-text-property 0 'tags item) "mine")
                                 (-when-let* ((marker (or (get-text-property 0 'org-marker item)
                                                          (get-text-property 0 'org-hd-marker item)))
                                              (file-path (-&gt;&gt; marker marker-buffer buffer-file-name))
                                              (parent (f-dirname file-path))
                                              (type (f-dirname parent)))
                                   ;; TODO this wont work on windows, use variables
                                   (when (equal "ext" (f-filename type))
                                     (f-filename parent))))))
                          (:discard (:anything t)))))))))))

</pre>
</div>
</div>
</div>

<div id="outline-container-org6f9088e" class="outline-3">
<h3 id="org6f9088e">org-fragtog</h3>
<div class="outline-text-3" id="text-org6f9088e">
<p>
Automatic LaTex fragment previews in org-mode.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package org-fragtog
  :config
  (add-hook 'org-mode-hook 'org-fragtog-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-org5a5b008" class="outline-3">
<h3 id="org5a5b008">linkmarks</h3>
<div class="outline-text-3" id="text-org5a5b008">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(eval `(use-package linkmarks
         :straight (linkmarks :type git :host github :repo "dustinlacewell/linkmarks")
         ;; :straight (linkmarks :type git :local-repo ,(my/project-directory "linkmarks/") :files ("linkmarks.el"))
         ))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgec4bf65" class="outline-3">
<h3 id="orgec4bf65">outshine</h3>
<div class="outline-text-3" id="text-orgec4bf65">
<p>
Outshine provides org-mode like functionality in other files like elisp source.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(use-package outshine
  :init (defvar outline-minor-mode-prefix "\M-#")
  :config (setq outshine-use-speed-commands t)
  :hook ((emacs-lisp-mode . outshine-mode) (nix-mode . outshine-mode)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org58cd020" class="outline-3">
<h3 id="org58cd020">org-ql</h3>
<div class="outline-text-3" id="text-org58cd020">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; (eval `(use-package org-ql
;;          :demand t
;;          :straight (org-ql :type git :host github :repo "dustinlacewell/org-ql")
;;          ;; :straight (org-ql :type git :local-repo ,(my/source-directory "org-ql"))
;;          ))

(eval `(use-package org-olp
         :demand t
         :straight (org-olp :type git :host github :repo "dustinlacewell/org-olp")
         ;; :straight (org-olp :type git :local-repo ,(my/project-directory "org-olp"))
         ))

(defun get-candidates (filename query)
  ;; (let* ((headlines (eval `(org-ql ,filename ,query)))
  ;;        (items (--map (plist-get it 'headline) headlines))
  ;;        (items (--sort (&lt; (plist-get it :begin)
  ;;                          (plist-get other :begin)) items)))
  ;;   (cl-loop for item in items
  ;;            for olp = (with-temp-buffer
  ;;                        (insert-file-contents filename)
  ;;                        (org-mode)
  ;;                        (goto-char (plist-get item :begin))
  ;;                        (org-get-outline-path t))
  ;;            for label = (string-join olp " / ")
  ;;            collect (list label item)))
  )

;; (get-candidates (my/org-file-name "notes.org") '(todo "TODO"))

(defun select-candidate (filename query)
  ;; (let* ((candidates (get-candidates filename query)))
  ;;   (car (helm :sources
  ;;              (helm-build-sync-source "active-todos"
  ;;                :candidates candidates
  ;;                :fuzzy-match t))))
  )

;; (select-candidate (my/org-file-name "notes.org") '(todo "TODO"))

(defun visit-candidate (filename query)
  ;; (let ((selection (select-candidate filename query)))
  ;;   (find-file filename)
  ;;   (goto-char (plist-get selection :begin))
  ;;   (beginning-of-line)
  ;;   (call-interactively 'org-shifttab)
  ;;   (call-interactively 'org-cycle))
  )

;; (visit-candidate my/notes-file-name '(todo))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7371913" class="outline-3">
<h3 id="org7371913">i-read-this</h3>
<div class="outline-text-3" id="text-org7371913">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun i-read-this ()
  (interactive)
  (org-entry-add-to-multivalued-property nil "readby" user-login-name))
</pre>
</div>
</div>
</div>

<div id="outline-container-org76cae90" class="outline-3">
<h3 id="org76cae90">don't prompt to confirm not prompting to confirm</h3>
<div class="outline-text-3" id="text-org76cae90">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq safe-local-variable-values '((org-confirm-elisp-link-function . nil)))
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2020-09-09 Wed 15:12</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
